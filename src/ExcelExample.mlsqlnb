[{"kind":1,"language":"markdown","value":"## Excel Support\n\nMLSQL provides datasource `excel` to help users load/save excel data.","outputs":[]},{"kind":2,"language":"mlsql","value":"load excel.`./example-data/excel/example_en.xlsx` \nwhere header=\"true\" as example_en_table;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"ID\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"C1\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"C2\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"_c3\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"_c4\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"_c5\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"ID\": \"1\",\n\t\t\t\"C1\": \"January\",\n\t\t\t\"C2\": \"Mon\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"2\",\n\t\t\t\"C1\": \"February\",\n\t\t\t\"C2\": \"Tue\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"3\",\n\t\t\t\"C1\": \"March\",\n\t\t\t\"C2\": \"Wed\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"4\",\n\t\t\t\"C1\": \"April\",\n\t\t\t\"C2\": \"Thu\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"5\",\n\t\t\t\"C1\": \"May\",\n\t\t\t\"C2\": \"Fri\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"6\",\n\t\t\t\"C1\": \"June\",\n\t\t\t\"C2\": \"Sat\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"7\",\n\t\t\t\"C1\": \"July\",\n\t\t\t\"C2\": \"Sun\"\n\t\t},\n\t\t{},\n\t\t{},\n\t\t{},\n\t\t{},\n\t\t{},\n\t\t{},\n\t\t{},\n\t\t{},\n\t\t{},\n\t\t{},\n\t\t{},\n\t\t{},\n\t\t{},\n\t\t{}\n\t]\n}"}]},{"kind":2,"language":"mlsql","value":"select ID,C1, C2 from example_en_table where ID<8 as new_example_en_table;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"ID\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"C1\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"C2\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"ID\": \"1\",\n\t\t\t\"C1\": \"January\",\n\t\t\t\"C2\": \"Mon\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"2\",\n\t\t\t\"C1\": \"February\",\n\t\t\t\"C2\": \"Tue\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"3\",\n\t\t\t\"C1\": \"March\",\n\t\t\t\"C2\": \"Wed\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"4\",\n\t\t\t\"C1\": \"April\",\n\t\t\t\"C2\": \"Thu\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"5\",\n\t\t\t\"C1\": \"May\",\n\t\t\t\"C2\": \"Fri\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"6\",\n\t\t\t\"C1\": \"June\",\n\t\t\t\"C2\": \"Sat\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"7\",\n\t\t\t\"C1\": \"July\",\n\t\t\t\"C2\": \"Sun\"\n\t\t}\n\t]\n}"}]},{"kind":2,"language":"mlsql","value":"save overwrite new_example_en_table as excel.`/tmp/new_example_en_table.xlsx` where header=\"true\";","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"owner\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"jobType\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"jobName\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"jobContent\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"groupId\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"progress\",\n\t\t\t\t\"type\": {\n\t\t\t\t\t\"type\": \"struct\",\n\t\t\t\t\t\"fields\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"name\": \"totalJob\",\n\t\t\t\t\t\t\t\"type\": \"long\",\n\t\t\t\t\t\t\t\"nullable\": false,\n\t\t\t\t\t\t\t\"metadata\": {}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"name\": \"currentJobIndex\",\n\t\t\t\t\t\t\t\"type\": \"long\",\n\t\t\t\t\t\t\t\"nullable\": false,\n\t\t\t\t\t\t\t\"metadata\": {}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"name\": \"script\",\n\t\t\t\t\t\t\t\"type\": \"string\",\n\t\t\t\t\t\t\t\"nullable\": true,\n\t\t\t\t\t\t\t\"metadata\": {}\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"startTime\",\n\t\t\t\t\"type\": \"long\",\n\t\t\t\t\"nullable\": false,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"timeout\",\n\t\t\t\t\"type\": \"long\",\n\t\t\t\t\"nullable\": false,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"owner\": \"admin\",\n\t\t\t\"jobType\": \"script\",\n\t\t\t\"jobName\": \"02514114-9f1c-4c97-96cf-1d1b74f88926\",\n\t\t\t\"jobContent\": \"save overwrite new_example_en_table as excel.`/tmp/new_example_en_table.xlsx` where header=\\\"true\\\";\",\n\t\t\t\"groupId\": \"49090e0f-e3e8-4601-a689-576b229a90d0\",\n\t\t\t\"progress\": {\n\t\t\t\t\"totalJob\": 1,\n\t\t\t\t\"currentJobIndex\": 1,\n\t\t\t\t\"script\": \"save overwrite new_example_en_table as excel.`/tmp/new_example_en_table.xlsx` where header=\\\"true\\\"\"\n\t\t\t},\n\t\t\t\"startTime\": 1630809104385,\n\t\t\t\"timeout\": -1\n\t\t}\n\t]\n}"}]},{"kind":2,"language":"mlsql","value":"!hdfs -ls /tmp/new_example_en_table.xlsx;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"fileSystem\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"fileSystem\": \"-rw-r--r--   1 allwefantasy wheel       3450 2021-09-05 10:31 /tmp/new_example_en_table.xlsx new_example_en_table.xlsx\\n\"\n\t\t}\n\t]\n}"}]}]