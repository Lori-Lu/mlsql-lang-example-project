[{"kind":1,"language":"markdown","value":"## StringIndex\nStringIndex is used to convert string to number and vice versa.\nIt will save the mapping in the specified files.","outputs":[]},{"kind":2,"language":"mlsql","value":"\nload excel.`./example-data/excel/example_en.xlsx` \nwhere header=\"true\" as example_en_table;\n\nselect * from example_en_table \nwhere C1 is not null\nas clean_example_en_table;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"ID\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"C1\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"C2\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"_c3\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"_c4\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"_c5\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"ID\": \"1\",\n\t\t\t\"C1\": \"January\",\n\t\t\t\"C2\": \"Mon\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"2\",\n\t\t\t\"C1\": \"February\",\n\t\t\t\"C2\": \"Tue\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"3\",\n\t\t\t\"C1\": \"March\",\n\t\t\t\"C2\": \"Wed\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"4\",\n\t\t\t\"C1\": \"April\",\n\t\t\t\"C2\": \"Thu\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"5\",\n\t\t\t\"C1\": \"May\",\n\t\t\t\"C2\": \"Fri\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"6\",\n\t\t\t\"C1\": \"June\",\n\t\t\t\"C2\": \"Sat\"\n\t\t},\n\t\t{\n\t\t\t\"ID\": \"7\",\n\t\t\t\"C1\": \"July\",\n\t\t\t\"C2\": \"Sun\"\n\t\t}\n\t]\n}"}]},{"kind":2,"language":"mlsql","value":"run clean_example_en_table as StringIndex.`/tmp/string_to_index_mapping` \nwhere inputCol=\"C1\" and outputCol=\"C1Num\" as temp;\nselect C1,C1Num from temp  as output;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"C1\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"C1Num\",\n\t\t\t\t\"type\": \"double\",\n\t\t\t\t\"nullable\": false,\n\t\t\t\t\"metadata\": {\n\t\t\t\t\t\"ml_attr\": {\n\t\t\t\t\t\t\"vals\": [\n\t\t\t\t\t\t\t\"July\",\n\t\t\t\t\t\t\t\"January\",\n\t\t\t\t\t\t\t\"February\",\n\t\t\t\t\t\t\t\"June\",\n\t\t\t\t\t\t\t\"May\",\n\t\t\t\t\t\t\t\"April\",\n\t\t\t\t\t\t\t\"March\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\t\"type\": \"nominal\",\n\t\t\t\t\t\t\"name\": \"C1Num\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"C1\": \"January\",\n\t\t\t\"C1Num\": 1\n\t\t},\n\t\t{\n\t\t\t\"C1\": \"February\",\n\t\t\t\"C1Num\": 2\n\t\t},\n\t\t{\n\t\t\t\"C1\": \"March\",\n\t\t\t\"C1Num\": 6\n\t\t},\n\t\t{\n\t\t\t\"C1\": \"April\",\n\t\t\t\"C1Num\": 5\n\t\t},\n\t\t{\n\t\t\t\"C1\": \"May\",\n\t\t\t\"C1Num\": 4\n\t\t},\n\t\t{\n\t\t\t\"C1\": \"June\",\n\t\t\t\"C1Num\": 3\n\t\t},\n\t\t{\n\t\t\t\"C1\": \"July\",\n\t\t\t\"C1Num\": 0\n\t\t}\n\t]\n}"}]},{"kind":2,"language":"mlsql","value":"-- register the mapping as an UDF\n-- this will create two UDFs:\n-- string_to_number  convert string to number\n-- string_to_number_r convert number to string\nregister StringIndex.`/tmp/string_to_index_mapping` as string_to_num;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"key\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"value\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": []\n}"}]},{"kind":2,"language":"mlsql","value":"select string_to_num(\"January\") as jan \nas output;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"jan\",\n\t\t\t\t\"type\": \"integer\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"jan\": 1\n\t\t}\n\t]\n}"}]},{"kind":2,"language":"mlsql","value":"-- or we can convert number back to string\nselect string_to_num_r(1) as jan \nas output;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"jan\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"jan\": \"January\"\n\t\t}\n\t]\n}"}]}]