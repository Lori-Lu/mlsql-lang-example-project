[{"kind":1,"language":"markdown","value":"# 使用MLSQL对1亿条淘宝用户行为数据分析\n\n一个CSV文件，时间区间为 2017-11-25 到 2017-12-03，总计 100,150,807 条记录，大小为 3.5 G，包含 5 个字段。\n下载地址：\n\n1. 阿里云： https://tianchi.aliyun.com/dataset/dataDetail?dataId=649&userId=1#1\n\n也可参考 [bigdata_analyse](https://github.com/TurboWay/bigdata_analyse) 获取数据。\n\n下载后解压放到 `/example-data` 目录下。","outputs":[]},{"kind":2,"language":"mlsql","value":"load csv.`/Users/allwefantasy/projects/mlsql-example-project/example-data/UserBehavior.csv` \nwhere header=\"true\"\nas UserBehavior;","outputs":[]},{"kind":1,"language":"markdown","value":"先进行数据清理，主要包括：\n\n1. 删除重复值\n2. 时间戳格式化\n3. 删除异常值。","outputs":[]},{"kind":2,"language":"mlsql","value":"--数据清洗，去掉完全重复的数据\nselect user_id, item_id, category_id, behavior_type, timestamp, datetime\nfrom user_behavior\ngroup by user_id, item_id, category_id, behavior_type, timestamp, datetime\nas user_behavior;\n\n--数据清洗，时间戳格式化成 datetime\nselect user_id, item_id, category_id, behavior_type, timestamp, from_unixtime(timestamp, 'yyyy-MM-dd HH:mm:ss')\nfrom user_behavior\nas user_behavior;\n\n--数据清洗，去掉时间异常的数据\nselect user_id, item_id, category_id, behavior_type, timestamp, datetime\nfrom user_behavior\nwhere cast(datetime as date) between '2017-11-25' and '2017-12-03'\nas user_behavior;\n\n--查看 behavior_type 是否有异常值\n-- select behavior_type from user_behavior group by behavior_type as output;\n--查看时间是否有异常值\n-- select date(datetime) as day from user_behavior group by date(datetime) order by day as output;\n","outputs":[]}]